# 安装部署

本文档详细说明了如何从零开始搭建开发环境以及如何将系统部署到生产服务器。

## 环境要求

在开始之前，请确保您的系统已安装以下软件：

- **Node.js**: 建议版本 v18.0 或更高 (推荐使用 LTS 版本)。
- **npm** 或 **pnpm**: 基础包管理工具。
- **PocketBase**: 单文件后端服务 (可从 [PocketBase 官网](https://pocketbase.io/) 下载)。

## 本地开发环境搭建

### 1. 克隆代码库

```bash
git clone <repository-url>
cd <project-folder>
```

### 2. 启动后端 (PocketBase)

1. 下载对应操作系统的 PocketBase 二进制文件。
2. 执行以下命令启动后端：

```bash
./pocketbase serve
```

默认管理界面地址：`http://127.0.0.1:8090/_/`
首次启动需要创建管理员账号。

### 3. 安装前端依赖

进入前端项目目录并安装依赖：

```bash
cd shadcn-admin
npm install
```

### 4. 运行开发服务器

```bash
npm run dev
```

启动后，访问 `http://localhost:5173`。

## 生产环境部署

### 1. 前端构建

在 `shadcn-admin` 目录下运行构建命令：

```bash
npm run build
```

构建产物将生成在 `dist` 目录中。

### 2. 静态资源服务器 (如 Nginx)

将 `dist` 目录下的所有文件上传到 Web 服务器，并配置 Nginx 指向该目录。

**Nginx 示例配置：**

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        root /path/to/your/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # 可选：代理 PocketBase 接口
    location /api/ {
        proxy_pass http://127.0.0.1:8090/api/;
        proxy_set_header Host $host;
    }
}
```

### 3. 后端持久化运行

在生产环境中，建议使用进程管理工具（如 `systemd` 或 `pm2`）来运行 PocketBase。

**Systemd 服务示例 (`/etc/systemd/system/pocketbase.service`):**

```ini
[Unit]
Description=pocketbase

[Service]
Type=simple
User=www-data
Group=www-data
WorkingDirectory=/var/www/pocketbase
ExecStart=/var/www/pocketbase/pocketbase serve --http="0.0.0.0:8090"
Restart=always

[Install]
WantedBy=multi-user.target
```

## 注意事项

- **环境变量**：确保前端 `src/lib/pocketbase.ts` 中的访问地址在生产环境中指向正确的后端 URL。
- **数据迁移**：PocketBase 的所有数据存储在 `pb_data` 目录中。部署时请务必备份该目录。
- **SSL/HTTPS**：强烈建议在生产环境中使用 SSL (可以通过 Nginx + Certbot 实现)。
